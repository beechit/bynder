<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
      data-namespace-typo3-fluid="true">

<div id="bynder-compactview"
     data-language="{language}"
     data-button="Pick a file from Bynder"
     data-folder="bynder-compactview"
     data-zindex="300"
     data-collections="false"
     data-header="false"
     data-autoload="true"
     data-fullScreen="true"
     data-defaultEnvironment="{apiBaseUrl}"
     data-button-id="1"
></div>
<script src="https://d8ejoa1fys2rk.cloudfront.net/5.0.5/modules/compactview/bynder-compactview-2-latest.js"></script>


<div id="importedAssets"></div>
<script>
    var element = ".{element}";
    BynderCompactView.open({
        onSuccess: function (selectedAssets) {
            var media = [];
            for (var i = 0; i < selectedAssets.length; i++) {
                media.push(selectedAssets[i].databaseId);
            }
            var details = {media: media, 'element': element},
                parentDocument = parent.document,
                contentIframe = parent.document.getElementById('typo3-contentIframe');

            if (contentIframe) {
                parentDocument = contentIframe.contentDocument;
            }

            parentDocument.dispatchEvent(new CustomEvent("BynderAddMedia", {"detail": details}));
        },
        collections: false,
        assetTypes: ['image'],
        container: document.getElementById('bynder-compactview'),
        portal: {
            url: document.getElementById('bynder-compactview').getAttribute('data-defaultEnvironment'),
            editable: false,
        }
    });
</script>

</html>
